{
  "evidence_type": "rbac_implementation",
  "step": "4.5",
  "timestamp": "2026-01-11T20:15:00Z",
  "status": "IMPLEMENTED",

  "implementation": {
    "service_file": "app/services/rbac_service.py",
    "roles": ["user", "admin"],
    "project_roles": ["owner", "collaborator", "viewer"]
  },

  "scopes": {
    "project:read": "View project and its runs",
    "project:write": "Modify project settings",
    "project:delete": "Delete project",
    "run:create": "Create runs in project",
    "run:cancel": "Cancel runs",
    "run:export": "Export run artifacts",
    "admin:users": "Manage users",
    "admin:quotas": "Manage quota policies",
    "admin:whitelist": "Manage alpha whitelist",
    "admin:kill_run": "Kill running simulations"
  },

  "project_role_scopes": {
    "owner": [
      "project:read",
      "project:write",
      "project:delete",
      "run:create",
      "run:cancel",
      "run:export"
    ],
    "collaborator": [
      "project:read",
      "run:create",
      "run:cancel",
      "run:export"
    ],
    "viewer": [
      "project:read",
      "run:export"
    ]
  },

  "admin_capabilities": {
    "has_all_scopes": true,
    "bypasses_project_checks": true,
    "can_access_all_tenants": true
  },

  "isolation_guarantees": {
    "C6_multi_tenant": true,
    "tenant_scope_verified": true,
    "project_isolation": true,
    "run_inherits_project_access": true
  },

  "service_methods": [
    "get_user_role",
    "is_admin",
    "get_project_role",
    "get_user_scopes",
    "check_scope",
    "require_scope",
    "check_project_access",
    "require_project_access",
    "check_run_access",
    "require_run_access",
    "is_whitelisted",
    "require_whitelist",
    "list_accessible_projects",
    "verify_tenant_scope",
    "require_tenant_scope"
  ],

  "error_response": {
    "error": "access_denied",
    "message": "You don't have permission to perform this action",
    "required_scope": "project:write",
    "resource_type": "project",
    "resource_id": "uuid"
  },

  "verification": {
    "rbac_service_exists": true,
    "admin_role_bypass": true,
    "tenant_isolation": true,
    "project_scoping": true
  }
}
