{
  "evidence_type": "backup_rollback_documentation",
  "step": "4.8",
  "timestamp": "2026-01-11T20:15:00Z",
  "status": "DOCUMENTED",

  "documentation_file": "apps/api/docs/backup_rollback.md",

  "backup_coverage": {
    "postgresql": {
      "provider": "Supabase",
      "automatic_backups": true,
      "retention_days": 7,
      "pitr_enabled": true,
      "manual_backup_command": "pg_dump $DATABASE_URL > backup.sql"
    },
    "redis": {
      "provider": "Upstash",
      "persistence": "AOF (Append Only File)",
      "replication": "Multi-zone",
      "auto_restore": true
    },
    "s3_storage": {
      "bucket": "agentverse-runs",
      "backup_bucket": "agentverse-runs-backup",
      "sync_command": "aws s3 sync source backup --storage-class GLACIER_IR"
    },
    "application": {
      "platform": "Railway",
      "rollback_command": "railway rollback {deployment_id}",
      "env_backup": "railway variables export > env_backup.json"
    }
  },

  "rollback_procedures": {
    "application_rollback": {
      "command": "railway rollback {previous_deployment_id}",
      "estimated_time": "5 minutes"
    },
    "database_migration_rollback": {
      "command": "alembic downgrade -1",
      "estimated_time": "5 minutes"
    },
    "database_restore": {
      "method": "Supabase PITR",
      "estimated_time": "30 minutes"
    },
    "full_dr": {
      "method": "Multi-service restore",
      "estimated_time": "4 hours"
    }
  },

  "rto_targets": {
    "bad_deployment": "5 minutes",
    "database_corruption": "30 minutes",
    "redis_failure": "1 minute (auto-failover)",
    "s3_outage": "N/A (multi-region)",
    "full_dr": "4 hours"
  },

  "data_retention": {
    "user_data": "Indefinite",
    "rep_artifacts": "90 days",
    "usage_events": "180 days",
    "daily_rollups": "365 days",
    "abort_logs": "365 days",
    "redis_counters": "48 hours (ephemeral)"
  },

  "verification_commands": [
    "curl -s https://api.agentverse.app/health | jq",
    "psql $DATABASE_URL -c 'SELECT 1'",
    "redis-cli -u $REDIS_URL PING",
    "railway deployments list --json | jq '.[0:5]'",
    "alembic current"
  ],

  "verification": {
    "documentation_exists": true,
    "postgresql_backup": true,
    "redis_persistence": true,
    "s3_backup_strategy": true,
    "railway_rollback": true,
    "alembic_migrations": true
  }
}
